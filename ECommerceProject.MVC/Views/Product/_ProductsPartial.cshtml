@using ECommerceProject.MVC.ViewModels
@model IEnumerable<ProductDetailsVM>

@foreach (var item in Model)
{
    var prod = item.Product;

    var imageUrl = string.IsNullOrEmpty(prod.ImageUrl)
        ? Url.Content("~/images/no-image.png")
        : Url.Content($"~/Files/{prod.ImageUrl}");

    <div class="col-lg-3 col-md-4 col-sm-6">
        <div class="card product-card h-100 shadow-sm">

            <img src="@imageUrl"
                 class="card-img-top product-img"
                 alt="@prod.Name">

            <div class="card-body d-flex flex-column">

                <h6 class="card-title fw-bold text-truncate">
                    @prod.Name
                </h6>

                <p class="card-text text-muted small flex-grow-1">
                    @(prod.Description?.Length > 80
                                    ? prod.Description.Substring(0, 80) + "..."
                                    : prod.Description)
            </p>

                <div class="d-grid gap-2">

                    <a asp-controller="Product"
                       asp-action="ViewProduct"
                       asp-route-prodId="@prod.Id"
                       class="btn btn-outline-primary btn-sm">
                        @SharedLocalizer["View"]
                    </a>

                @if (item.IsInCart)
                    {
                        <button class="btn btn-success btn-sm" disabled>
                            @SharedLocalizer["AddedToYourCart"]
                        </button>
                    }
                    else
                    {
                        <button class="btn btn-primary btn-sm add-to-cart-btn"
                                data-product-id="@prod.Id"
                                data-price="@prod.Price">
                            @SharedLocalizer["AddToCart"]
                        </button>
                    }

                </div>
            </div>
        </div>
    </div>
}
